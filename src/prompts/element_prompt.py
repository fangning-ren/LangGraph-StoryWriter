GENERATE_STORY_ELEMENTS_PROMPT = """
我正在写一个虚构故事，想请你帮忙把故事的元素写出来。

这是我的故事的需求。
<PROMPT>
{_Prompt}
</PROMPT>

参考用户的需求，包括风格和题材，以及人称等。如果用户的信息很多，请尝试总结人物性格。请按照以下格式填写您的回复：

<RESPONSE_TEMPLATE>
# 故事标题

## 类型
- **类别**：（例如：爱情、悬疑、科幻、奇幻、恐怖）

## 主题
- **中心思想或信息**：

## 节奏
- **速度**：（例如：慢、快）

## 风格
- **语言运用**：（例如：句子结构、词汇、语气、比喻）

## 情节
- **开场**：
- **高潮**：
- **收尾**：
- **结局**：

## 背景
### 背景 1
- **时间**：（例如：现在、将来、过去）
- **地点**： （例如：城市、乡村、异星）
- **文化**：（例如：现代、中世纪、异星）
- **氛围**：（例如：阴郁、高科技、反乌托邦）

（重复以上结构添加更多场景）

## 冲突
- **类型**：（例如：内部、外部）
- **描述**：

## 象征意义
### 符号 1
- **符号**：
- **含义**：

（重复以上结构添加更多符号）

## 人物
### 主要人物
#### 主要人物 1
- **姓名**：
- **外貌描述**：
- **性格**：
- **动机**：
- **特殊能力（如有）**:
- **背景（如果提供了，尽可能详细的放在这里）**：

（重复以上结构添加更多主要人物）

### 配角
#### 角色 1
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 2
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 3
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 4
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 5
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 6
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 7
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 8
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

......
（重复或删减上述结构以添加其他配角）

</RESPONSE_TEMPLATE>

当然，不要包含 XML 标签 - 这些标签只是为了举例说明。
此外，括号中的项目只是为了让您更好地了解要写的内容，也应该从您的回复中删除。
"""

EXTRACT_ELEMENTS_PROMPT = """
你是一个有帮助的AI助手。现在你需要从以下用户提供的故事元素中提取出除了角色信息以外的其他元素。要求只提取故事元素，并且提取的故事元素要保持**原封不动**，包括markdown格式和缩进都要**原封不动**。你的回复应为以下格式：
<RESPONSE_TEMPLATE>
# 故事标题

## 类型
- **类别**：（例如：爱情、悬疑、科幻、奇幻、恐怖）

## 主题
- **中心思想或信息**：

## 节奏
- **速度**：（例如：慢、快）

## 风格
- **语言运用**：（例如：句子结构、词汇、语气、比喻）

## 情节
- **开场**：
- **高潮**：
- **收尾**：
- **结局**：

## 背景
### 背景 1
- **时间**：（例如：现在、将来、过去）
- **地点**： （例如：城市、乡村、异星）
- **文化**：（例如：现代、中世纪、异星）
- **氛围**：（例如：阴郁、高科技、反乌托邦）

（重复以上结构添加更多场景）

## 冲突
- **类型**：（例如：内部、外部）
- **描述**：

## 象征意义
### 符号 1
- **符号**：
- **含义**：

（重复以上结构添加更多符号）
</RESPONSE_TEMPLATE>

请从以下用户提供的故事元素中提取出除了角色信息以外的其他元素：
<STORY_ELEMENTS>

{_StoryElements}

</STORY_ELEMENTS>

您的回复中不能包含<STORY_ELEMENTS>标签或其他XML标签，不要包含除了故事元素定义以外的任何信息，尤其不要包含角色信息。请确保提取的故事元素是完整的，并且保持原封不动。请严格遵循以上markdown格式，包括每个标题开头的"#"和每个属性的"- **"格式。您的回复会被送往计算机程序进行分割和处理，因此请务必确保格式正确。
"""

EXTRACT_CHARACTER_PROMPT = """
你是一个有帮助的AI助手。现在你需要从以下用户提供的故事元素中提取出角色信息。要求只提取角色信息，并且提取的角色信息要保持**原封不动**。你的回复应为以下格式：

<RESPONSE_TEMPLATE>

#### 主要人物 1
- **姓名**：
- **外貌描述**：
- **性格**：
- **动机**：
- **特殊能力（如有）**:
- **背景**：

#### 主要人物 1
- **姓名**：
- **外貌描述**：
- **性格**：
- **动机**：
- **特殊能力（如有）**:
- **背景**：

...（重复以上结构添加更多主要人物）

#### 角色 1
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

#### 角色 1
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:

...（重复以上结构添加更多配角）
</RESPONSE_TEMPLATE>

请从以下用户提供的故事元素中提取出角色信息：

<STORY_ELEMENTS>

{_StoryElements}

</STORY_ELEMENTS>

您的回复中不能包含<STORY_ELEMENTS>标签或其他XML标签，不要包含除了角色定义以外的任何信息，更不要修改！只能包含原封不动的角色信息。请确保提取的角色信息是完整的，并且保持原封不动。请严格遵循以上markdown格式，包括每个角色开头的"####"和每个属性的"- **"格式。您的回复会被送往计算机程序进行分割和处理，因此请务必确保格式正确。
"""


ADD_CHARACTER_PROMPT = """
你是一个擅长角色塑造的作家。你需要根据用户提供的故事元素和情节，判断当前章节是否需要补充新的角色，以及某些被提到但是没有被罗列在故事元素中的角色。
现在你所在创造的故事背景信息以及故事总体大纲如下：

<BACKGROUND>
{_Background}
</BACKGROUND>

故事进展到了第{_ChapterNum}章，这一章的大纲如下：
<CHAPTER_OUTLINE>
{_ChapterOutline}
</CHAPTER_OUTLINE>

已经存在的角色信息如下：
<EXISTING_CHARACTERS>
{_ExistingCharacters}
</EXISTING_CHARACTERS>

请根据以上信息，判断是否需要添加新的角色。如果需要，请按照以下格式填写您的回复：
<RESPONSE_TEMPLATE>
#### 角色 1
- **姓名**: [角色姓名]
- **外貌描述**: [角色外貌描述]
- **性格**: [角色性格描述]
- **背景**: [角色背景描述]
- **人际关系**: [角色与其他角色的人际关系]
- **特殊能力（如有）**: [角色的特殊能力]
- **故事中的角色**: [角色在故事中的作用或地位]

</RESPONSE_TEMPLATE>

请注意以下几点：
- 只在需要添加新角色时才填写回复。如果不需要添加新角色，请直接回复"不需要添加新角色"。
- 新角色最好有明确的姓名和外貌描述。添加时其身份信息需尽可能清晰具体。
- 如果角色是一个匿名的神秘角色，请首先检查故事大纲中是否已经强调过ta的真实身份。如果已经强调过，不要添加角色信息。
- 对于匿名并且未提及真实身份的角色，请在角色描述中注明"匿名角色"或"神秘角色"，并尽可能提供其他可用信息，如外貌、性格等。


"""


CHARACTER_APPEAR_PROMPT = """
你是一个擅长分析小说文本的AI助手。你需要从以下提供的情节中，判断以下情节是否与指定角色相关。
“相关”意味着以下情景：
- 角色出现在情节中。
- 角色被提及或讨论。
- 角色被间接影响了。

您所分析的情节如下：
<CHAPTER_CONTENT>
{_ChapterContent}
</CHAPTER_CONTENT>

您需要判断以下角色是否与上述情节相关。
<CHARACTER>
{_Character}
</CHARACTER>

请严格按照json格式输出您的判断结果。使用以下格式：
{{
  "IsAppeared": true,  # 如果角色出场或被提及，值为true，否则为false
}}
请确保您的输出仅包含JSON格式的响应，不要包含任何其他文本或解释。您的响应将由计算机程序解析，因此请务必确保格式正确。
"""


CHARACTER_UPDATE_PROMPT = """
你是一个擅长角色塑造的作家。你在依据情节的发展更新角色的信息，包括能力，性格，历史经历，人际关系等。

现在你所在创造的故事背景信息以及故事大纲如下：

<BACKGROUND>
{_Background}
</BACKGROUND>

故事进展到了第{_ChapterNum}章，这一章的内容如下：
<CHAPTER_CONTENT>
{_ChapterContent}
</CHAPTER_CONTENT>

您需要依照当前情节和故事整体的发展，更新以下角色的信息。

<CHARACTER>

{_Character}

</CHARACTER>

请根据以上信息，按照以下格式填写您的回复。请确保您的回复简洁明了。

<CHARACTER_TEMPLATE>
#### 角色 1 (或主要角色 1)
- **姓名**:
- **外貌描述**:
- **性格**:
- **背景**:
- **人际关系**:
- **特殊能力（如有）**:
- **故事中的角色**:
- **历史经历**:
</CHARACTER_TEMPLATE>

在更新角色信息时，请注意以下问题：
- 角色是否认识了新的角色？如果是，请修改其人际关系。
- 角色是否学习有了新的能力？如果是，请修改其特殊能力。
- 角色在本章节中是否经历了重要事件，如是，在历史经历后**添加**简短的描述，不要删除之前的历史经历。
- 本章节中是否有重要的情节发展影响了角色的性格？如果是，请修改其性格描述。
- 角色是否出现外貌变化，如体型、发型、特殊装扮等？如果是，请修改其外貌描述。
- 本章节是否揭露了角色新的背景故事？如果是，请修改其背景描述。

请确保您的回复足够简洁。遵守以上markdown格式，包括第一行的"####"，以及每个属性的格式。但不要包含<CHARACTER_TEMPLATE>等xml标签。您的回复会被送往计算机程序进行分割和处理，因此请务必确保格式正确。
"""

CHARACTER_EXISTS_PROMPT = """
你是一个擅长分析小说文本的AI助手。你需要判断以下描述是否内容包含且仅包含一个角色的描述。该描述位于xml标签，<CHARACTER>和</CHARACTER>之间。
如果该描述包含且仅包含一个角色的描述，请判断该角色是否已经存在于已存在的角色列表中。

角色描述的模板如下：
- **姓名**: [角色姓名]
- **外貌描述**: [角色外貌描述]
- **性格**: [角色性格描述]
- **背景**: [角色背景描述]
...(重复以上结构添加更多角色属性)

以下位于xml标签，<CHARACTER>和</CHARACTER>，之间的内容，是您需要判断的角色描述：
<CHARACTER>
{_Character}
</CHARACTER>

如果该描述确实符合以下条件：
1. 明确描述的是一个角色，不是一件物品。
2. 至少包含姓名、外貌描述、性格、背景等基本信息。
3. 没有包含多个角色信息，仅包含一个角色。
4. 姓名、外貌描述、性格、背景等字段符合给出的markdown格式。
那么请将其视为一个角色表述。


如果该角色是一个角色的描述，请检查以下已存在的角色列表，判断该角色是否已经存在。如果列表为空或没有包含该角色，则认为该角色尚且不存在。
以下是已存在的角色列表：

<EXISTING_CHARACTERS>
{_ExistingCharacters}
</EXISTING_CHARACTERS>

不论<CHARACTER>和</CHARACTER>之间的输入内容为什么内容，请严格按照json格式输出您的判断结果。使用以下json格式：

{{
  "IsCharacter": true, 
  "IsExists": true, 
}}

其中，“IsCharacter”表示<CHARACTER>和</CHARACTER>之间的内容是否包含且仅包含一个角色的描述。如果是，则为true，否则为false。
“IsExists”表示该角色是否已经存在于已存在的角色列表中。如果是，则为true，否则为false。

请确保您的输出仅包含JSON格式的响应，不要包含任何其他文本或解释。您的响应将由计算机程序解析，因此请务必确保格式正确。
"""
